
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Read the full documentation for ProvisionGenie ðŸ§ž to provision custom-tailored Microsoft Teams teams based on your user's needs">
      
      
      
      
        <link rel="canonical" href="https://provisiongenie.com/corecomponents/logicapps/">
      
      <link rel="icon" href="../../media/site/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-7.3.4">
    
    
      
        <title>Overview - ProvisionGenie</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/styles.css">
    
    
      


    
    
    
    
    
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="ProvisionGenie - Overview" />
    <meta property="og:description" content="Read the full documentation for ProvisionGenie ðŸ§ž to provision custom-tailored Microsoft Teams teams based on your user's needs" />
    <meta property="og:url" content="https://provisiongenie.com/corecomponents/logicapps/" />
    <meta property="og:image" content="https://provisiongenie.com/media/site/socialcard.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1277" />
    <meta property="og:image:height" content="640" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ProvisionGenie - Overview" />
    <meta name="twitter:description" content="Read the full documentation for ProvisionGenie ðŸ§ž to provision custom-tailored Microsoft Teams teams based on your user's needs" />
    <meta name="twitter:image" content="https://provisiongenie.com/media/site/socialcard.png" />

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#azure-logic-apps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ProvisionGenie" class="md-header__button md-logo" aria-label="ProvisionGenie" data-md-component="logo">
      
  <img src="../../media/site/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ProvisionGenie
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ProvisionGenie/ProvisionGenie" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        ProvisionGenie
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../solutionoverview/" class="md-tabs__link md-tabs__link--active">
        Core components
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../deploymentguide/" class="md-tabs__link">
        Deployment guide
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/releasenotes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ProvisionGenie" class="md-nav__button md-logo" aria-label="ProvisionGenie" data-md-component="logo">
      
  <img src="../../media/site/logo.svg" alt="logo">

    </a>
    ProvisionGenie
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ProvisionGenie/ProvisionGenie" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" data-md-state="indeterminate" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          ProvisionGenie
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ProvisionGenie" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          ProvisionGenie
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../adminfactsheet/" class="md-nav__link">
        Admin fact sheet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../costestimation/" class="md-nav__link">
        Cost estimation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../architecturedecisions/" class="md-nav__link">
        Architecture decisions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../designguide/" class="md-nav__link">
        Design Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../accessibilityguide/" class="md-nav__link">
        Accessibility guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Core components
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core components" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Core components
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../solutionoverview/" class="md-nav__link">
        Solution Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" data-md-state="indeterminate" type="checkbox" id="__nav_2_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_2">
          Canvas App
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Canvas App" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Canvas App
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../canvasapp/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../howtobuildthecanvasapp/" class="md-nav__link">
        How to build
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" data-md-state="indeterminate" type="checkbox" id="__nav_2_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Dataverse
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Dataverse" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Dataverse
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dataverse/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" type="checkbox" id="__nav_2_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_4">
          Logic Apps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Logic Apps" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Logic Apps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Overview
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-main-flow" class="md-nav__link">
    1. Main flow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-team" class="md-nav__link">
    2. Create team
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-add-people" class="md-nav__link">
    3. Add people
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-create-listlibrary" class="md-nav__link">
    4. Create List/Library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-create-task-list" class="md-nav__link">
    5. Create Task List
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-welcome-package" class="md-nav__link">
    6. Welcome Package
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-add-notebook" class="md-nav__link">
    7. Add Notebook
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" data-md-state="indeterminate" type="checkbox" id="__nav_2_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2_5">
          Language Packs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Language Packs" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Language Packs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../languagepacks/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Deployment guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deployment guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Deployment guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" data-md-state="indeterminate" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Clean install
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Clean install" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Clean install
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/" class="md-nav__link">
        Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/copiedvalues/" class="md-nav__link">
        Copied values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/0-forkclone/" class="md-nav__link">
        0. Fork and clone this repository
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/1-registerapp/" class="md-nav__link">
        1. Register application in Azure AD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/2-importsolution/" class="md-nav__link">
        2. Import Dataverse solution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/3-deployazureresources/" class="md-nav__link">
        3. Deploy Azure resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/4-addtoteams/" class="md-nav__link">
        4. Add ProvisionGenie to Teams
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/5-postdeploycleanup/" class="md-nav__link">
        5. Post Deployment cleanup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentsguide/6-knownissues.md" class="md-nav__link">
        6. Known Issues
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" data-md-state="indeterminate" type="checkbox" id="__nav_3_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Upgrade
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Upgrade" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Upgrade
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deploymentguide/upgradev100v200/" class="md-nav__link">
        Upgrade v1.0.0 --> v2.0.0
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/releasenotes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/sessions/" class="md-nav__link">
        Sessions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/developers/" class="md-nav__link">
        Developers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-main-flow" class="md-nav__link">
    1. Main flow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-create-team" class="md-nav__link">
    2. Create team
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-add-people" class="md-nav__link">
    3. Add people
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-create-listlibrary" class="md-nav__link">
    4. Create List/Library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-create-task-list" class="md-nav__link">
    5. Create Task List
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-welcome-package" class="md-nav__link">
    6. Welcome Package
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-add-notebook" class="md-nav__link">
    7. Add Notebook
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ProvisionGenie/ProvisionGenie/blob/main/docs/docs/corecomponents/logicapps.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="azure-logic-apps">Azure Logic Apps<a class="headerlink" href="#azure-logic-apps" title="Permanent link">&para;</a></h1>
<p><img alt="header image" src="../../media/index/Genie_Header.png" /></p>
<p>We created 7 Azure Logic Apps to handle the provisioning of the Teams:</p>
<p>Our flows pick up the values logged in the Dataverse tables to provision what the user requested:</p>
<ul>
<li><a href="#azure-logic-apps">Azure Logic Apps</a><ul>
<li><a href="#1-main-flow">1. Main flow</a></li>
<li><a href="#2-create-team">2. Create team</a></li>
<li><a href="#3-add-people">3. Add people</a></li>
<li><a href="#4-create-listlibrary">4. Create List/Library</a></li>
<li><a href="#5-create-task-list">5. Create Task List</a></li>
<li><a href="#6-welcome-package">6. Welcome Package</a></li>
<li><a href="#7-add-notebook">7. Add Notebook</a></li>
</ul>
</li>
</ul>
<h3 id="1-main-flow">1. Main flow<a class="headerlink" href="#1-main-flow" title="Permanent link">&para;</a></h3>
<p>The main flow takes care of the logic of the flows: executing the different steps in the right order and providing the right input. An overview of the Logic App is added below.</p>
<p><img alt="Screenshot of the main flow" src="../../media/corecomponents/LogicApps-Main.png" /></p>
<ol>
<li>The main flow triggers when a new row is added into the <strong>Teams Requests</strong> table in Dataverse.</li>
<li>The internal name of the to be created team is generated using the name provided by the team owner and a generated guid. This ensures that all team names are unique.</li>
<li>The technical name is updated in the Teams Request row so that admins can easily find out which requests are linked to which Microsoft Teams teams.</li>
<li>7 variables are initialized that are used later on in the flow</li>
<li><code>Channels</code>: contains the array representation of the channels that need to be created.</li>
<li><code>DriveExistsCode</code>: stores the response of an HTTP request to check whether the SharePoint library has already been created for the team.</li>
<li><code>SiteExistsCode</code>: stores the response of an HTTP request to check whether the SharePoint site for the team has already been created.</li>
<li><code>LibraryColumns</code>: array representation of the columns that need to be created in the library.</li>
<li><code>ListColumns</code>: array representation of the columns that need to be created in the list.</li>
<li><code>Members</code>: contains members to be added to the Teams</li>
<li><code>Owners</code>: contains owners to be added to the Teams</li>
<li>A 1 minute delay is added to ensure that the channels and other related table rows are linked to the Teams request row in Dataverse, since these cannot be linked upon creation of the Teams request row.</li>
<li>The team is created in the Create Team scope, which is expanded below</li>
<li>The related team channel rows are listed</li>
<li>The channels are added into the <code>Channels</code> variable</li>
<li>A child logic app is called with the team information and channels as input</li>
<li>The Team ID is extracted from the child logic app's response</li>
<li>We wait until we get confirmation that the SharePoint site for the team has been created</li>
<li>We wait until we get confirmation that the default files library for the team has been created</li>
<li>The folder path for the default files library is composed based on the output of the previous actions</li>
</ol>
<p><img alt="Scope Create Team" src="../../media/corecomponents/LogicApps-Main-ScopeCreateTeam.png" /></p>
<ol>
<li>The lists and libraries defined in the request are created in the Create Lists and Libraries scope.</li>
<li>The related list rows are listed</li>
<li>For each related list<ol>
<li>The related columns are listed</li>
<li>The column definition is added to the Columns variable</li>
<li>A child logic app is called to create the list with its columns</li>
</ol>
</li>
<li>The related library rows are listed</li>
<li>For each related library<ol>
<li>The related columns are listed</li>
<li>The columns definition is added to the Columns variable</li>
<li>A child logic app is called to create the library with its columns</li>
</ol>
</li>
</ol>
<p><img alt="Scope Create Lists and Libraries" src="../../media/corecomponents/LogicApps-Main-ScopeCreateListsLibraries.png" /></p>
<ol>
<li>The task list is added to the team if the owner has indicated they want this in their team</li>
<li>The welcome package is added to the team if the owner has indicated they want this in their team</li>
</ol>
<p><img alt="Scope Add People" src="../../media/corecomponents/LogicApps-Main-AddPeople-member.png" />
<img alt="Scope Add People" src="../../media/corecomponents/LogicApps-Main-AddPeople-owner.png" />
<img alt="Scope Add People" src="../../media/corecomponents/LogicApps-Main-AddPeople-condition.png" /></p>
<ol>
<li>The related rows of the intersection table <code>pg_teamsuser_teamsrequest_members</code> get listed</li>
<li>For each member the <code>members</code> variable gets appended to then reflect the UPN</li>
<li>The related rows of the intersection table <code>pg_teamsuser_teamsrequest_owners</code> get listed</li>
<li>For each member the <code>owners</code> variable gets appended to then reflect the UPN</li>
<li>In case members or owners are not empty, the <code>ProvisionGenie-AddPeople</code> flow gets called</li>
</ol>
<h3 id="2-create-team">2. Create team<a class="headerlink" href="#2-create-team" title="Permanent link">&para;</a></h3>
<p>In the Create team flow, the requested team is created with the specified channels. Additionally, the wiki is removed from each of the channels. An overview of the flow is added below.</p>
<p><img alt="Create Team logic app overview" src="../../media/corecomponents/LogicApps-CreateTeam.png" /></p>
<ol>
<li>The Logic Apps flow is triggered from an HTTP request, for example when being called as a child logic app</li>
<li>6 variables are initialized</li>
<li><code>TechnicalName</code>: the internal name that the team should be initialized with, this is used in the email address and SharePoint site url for the team.</li>
<li><code>DisplayName</code>: the name that users should see in the Microsoft Teams app.</li>
<li><code>Description</code>: the description of the team.</li>
<li><code>TeamCreationRequestCode</code>: variable to store the response the HTTP request to create the team to check whether the request was accepted.</li>
<li><code>TeamCreationStatus</code>: variable to store the response of an HTTP request to check whether the creation of the team has completed.</li>
<li><code>NewTeamId</code>: the ID of the new team.</li>
<li>The information of the Team owner is requested to Azure AD using an HTTP request</li>
<li>The owner information is parsed so its properties can be used later in the Logic Apps flow</li>
<li>The group for the team is created as a private group</li>
<li>The group creation request body is parsed to use the properties later in the Logic Apps flow</li>
<li>The group ID is stored in the <code>NewTeamId</code> variable</li>
<li>The following actions are done in a loop because this does not always succeed on the first try</li>
<li>A request is sent to "teamify" the created group</li>
<li>The status code is saved in the <code>TeamCreationStatus</code> variable</li>
<li>If team creation has not been accepted, there is a delay of 10 seconds</li>
<li>The loop will stop when the HTTP request to teamify the group has been accepted</li>
</ol>
<p><img alt="Teamify loop" src="../../media/corecomponents/LogicApps-CreateTeam-LoopTeamify.png" /></p>
<ol>
<li>The headers of the team creation request are parsed to extract the information for use later in the Logic Apps flow</li>
<li>The following actions are done in a loop because teamification of the group can take some time<ol>
<li>An HTTP request is sent to determine the creation status of the team for the group</li>
<li>The response is parsed</li>
<li><code>TeamsCreationStatus</code> is updated with the status of the HTTP request</li>
<li>If team creation has not succeeded, a 10 second delay is added</li>
<li>The loop will stop when team creation has succeeded</li>
</ol>
</li>
</ol>
<p><img alt="Teamify completed loop" src="../../media/corecomponents/LogicApps-CreateTeam-LoopTeamifyCompleted.png" /></p>
<ol>
<li>The channels that have been created in the team are listed</li>
<li>Channel information is parsed so it can be used in the following actions</li>
<li>For each channel<ol>
<li>The wiki tab is identified based on its name</li>
<li>The wiki tab info is parsed</li>
<li>The wiki tab is deleted from the channel</li>
</ol>
</li>
</ol>
<p><img alt="Wiki deletion actions" src="../../media/corecomponents/LogicApps-CreateTeam-ForEachChannel.png" /></p>
<ol>
<li>A response is provided to the caller of the logic app with the team id.</li>
</ol>
<h3 id="3-add-people">3. Add people<a class="headerlink" href="#3-add-people" title="Permanent link">&para;</a></h3>
<p><img alt="AddPeople Logic App" src="../../media/corecomponents/LogicApps-AddPeople.png" /></p>
<ol>
<li>The logic app is triggered from a HTTP request as a child flow</li>
<li>An array variable <code>People</code> is initialized</li>
<li>The members get splitted by an <code>;</code></li>
<li>the <code>People</code> variable gets appended with the body that we need in the HTTP request to add members</li>
<li>The owners get splitted by an <code>;</code></li>
<li>the <code>People</code> variable gets appended with the body that we need in the HTTP request to add owners</li>
<li>HTTP request adds both members get added in a single call</li>
<li>for each guest, the UPN gets created</li>
<li><strong>TRY</strong> scope: we check if this user already exists in Azure Active Directory</li>
<li><strong>CATCH</strong> scope: we invite the user to the tenat and wait until they accepted the invitation and update the user information for <code>firstName</code>, <code>lastName</code> and <code>Organization</code></li>
<li>We add the user to the group</li>
<li>Respond to the request caller</li>
</ol>
<h3 id="4-create-listlibrary">4. Create List/Library<a class="headerlink" href="#4-create-listlibrary" title="Permanent link">&para;</a></h3>
<p>As the logic for creating a list and creating a library is very similar, we do this in one flow:</p>
<p><img alt="Create List/Library logic app overview" src="../../media/corecomponents/LogicApps-CreateListLibrary.png" /></p>
<ol>
<li>The logic app is triggered from a HTTP request, for example as a child logic app.</li>
<li>A <code>ListColumns</code> variable is initialized to store the column definition</li>
<li>A <code>ResourceType</code> variable is initialized to store if it is a list or a library</li>
<li>For each of the columns that are specified in the trigger</li>
<li>Depending on the type of column, append the column definition to the <code>ListColumns</code> variable</li>
<li>Switch cases for the columnm types</li>
<li>Switch cases for the resource types</li>
<li>Create the list/library using a request using the resource type</li>
<li>Respond to the request caller</li>
</ol>
<h3 id="5-create-task-list">5. Create Task List<a class="headerlink" href="#5-create-task-list" title="Permanent link">&para;</a></h3>
<p>The Create Task list logic app uses the <strong>CreateLibraryList</strong> logic app to create a task list using a fixed definition of columns.</p>
<p><img alt="Create Task List overview" src="../../media/corecomponents/LogicApps-CreateTaskList.png" /></p>
<ol>
<li>The Logic Apps flow is triggered from a HTTP request, for example as a child Logic Apps flow</li>
<li>A <code>listColumns</code> variable is initialized with a fixed definition of the columns needed for the task list</li>
<li>The Create List Logic Apps flow is called with the task list fixed column definition to create the task list</li>
<li>Respond to the request caller</li>
</ol>
<h3 id="6-welcome-package">6. Welcome Package<a class="headerlink" href="#6-welcome-package" title="Permanent link">&para;</a></h3>
<p>The welcome package adds a url with training material to the General channel of the new team</p>
<p><img alt="Welcome Package Overview" src="../../media/corecomponents/LogicApps-WelcomePackage.png" /></p>
<ol>
<li>The Logic Apps is triggered from a HTTP request, for example as a child logic app</li>
<li>The request body is parsed to extract the required information</li>
<li>2 variables are initialized:</li>
<li><code>TeamId</code>: the ID of the team to which the welcome package should be added</li>
<li><code>Owner</code>: the owner of the team (UPN)</li>
<li>A HTTP request lists the channels in the team</li>
<li>The channel info is parsed</li>
<li>The General channel is always the first channel returned when the channels are listed, this is extracted from the channel info</li>
<li>An HTTP request is sent to add the training material URLas a website tab in the new team's general channel</li>
<li>Respond to the request caller</li>
</ol>
<h3 id="7-add-notebook">7. Add Notebook<a class="headerlink" href="#7-add-notebook" title="Permanent link">&para;</a></h3>
<p>This flow adds the notebook of the SharePoint sites, that backs the team, to the channel <strong>General</strong> and creates the first section and the first page.</p>
<p><img alt="Add Notebook Overview" src="../../media/corecomponents/LogicApps-AddNotebook.png" /></p>
<ol>
<li>The Logic Apps is triggered from a HTTP request, for example as a child logic app</li>
<li>An HTTP request lists the channels in the team</li>
<li>An HTTP request triggers the creation of the Notebook in the site that backs the Team.</li>
<li>An HTTP request gets the notebook information</li>
<li>An HTTP request creates a section in the notebook</li>
<li>An HTTP request creates a page in the notebook</li>
<li>A variable is initialized for the <code>Notebook URL</code></li>
<li>An HTTP request adds the Notebook to the Channel <strong>General</strong></li>
<li>Respond to the request caller</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../dataverse/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="../languagepacks/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Overview
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.sections", "navigation.expand"], "search": "../../assets/javascripts/workers/search.8397ff9e.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>